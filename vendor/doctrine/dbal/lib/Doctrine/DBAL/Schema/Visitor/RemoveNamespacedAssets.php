<?php
 namespace Doctrine\DBAL\Schema\Visitor; use Doctrine\DBAL\Schema\Table; use Doctrine\DBAL\Schema\Schema; use Doctrine\DBAL\Schema\ForeignKeyConstraint; use Doctrine\DBAL\Schema\Sequence; class RemoveNamespacedAssets extends AbstractVisitor { private $schema; public function acceptSchema(Schema $schema) { $this->schema = $schema; } public function acceptTable(Table $table) { if ( ! $table->isInDefaultNamespace($this->schema->getName())) { $this->schema->dropTable($table->getName()); } } public function acceptSequence(Sequence $sequence) { if ( ! $sequence->isInDefaultNamespace($this->schema->getName())) { $this->schema->dropSequence($sequence->getName()); } } public function acceptForeignKey(Table $localTable, ForeignKeyConstraint $fkConstraint) { if ( ! $this->schema->hasTable($fkConstraint->getForeignTableName())) { $localTable->removeForeignKey($fkConstraint->getName()); return; } $foreignTable = $this->schema->getTable($fkConstraint->getForeignTableName()); if ( ! $foreignTable->isInDefaultNamespace($this->schema->getName())) { $localTable->removeForeignKey($fkConstraint->getName()); } } } 
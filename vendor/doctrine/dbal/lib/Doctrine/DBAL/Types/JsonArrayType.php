<?php
 namespace Doctrine\DBAL\Types; use Doctrine\DBAL\Platforms\AbstractPlatform; class JsonArrayType extends Type { public function getSQLDeclaration(array $fieldDeclaration, AbstractPlatform $platform) { return $platform->getJsonTypeDeclarationSQL($fieldDeclaration); } public function convertToDatabaseValue($value, AbstractPlatform $platform) { if (null === $value) { return null; } return json_encode($value); } public function convertToPHPValue($value, AbstractPlatform $platform) { if ($value === null || $value === '') { return array(); } $value = (is_resource($value)) ? stream_get_contents($value) : $value; return json_decode($value, true); } public function getName() { return Type::JSON_ARRAY; } public function requiresSQLCommentHint(AbstractPlatform $platform) { return ! $platform->hasNativeJsonType(); } } 
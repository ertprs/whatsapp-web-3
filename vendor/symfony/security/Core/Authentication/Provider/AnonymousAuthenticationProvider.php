<?php
 namespace Symfony\Component\Security\Core\Authentication\Provider; use Symfony\Component\Security\Core\Authentication\Token\TokenInterface; use Symfony\Component\Security\Core\Exception\BadCredentialsException; use Symfony\Component\Security\Core\Authentication\Token\AnonymousToken; class AnonymousAuthenticationProvider implements AuthenticationProviderInterface { private $secret; public function __construct($secret) { $this->secret = $secret; } public function authenticate(TokenInterface $token) { if (!$this->supports($token)) { return; } if ($this->secret !== $token->getSecret()) { throw new BadCredentialsException('The Token does not contain the expected key.'); } return $token; } public function supports(TokenInterface $token) { return $token instanceof AnonymousToken; } } 
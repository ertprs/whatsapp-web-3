<?php
 namespace Symfony\Component\Security\Guard\Token; use Symfony\Component\Security\Core\Authentication\Token\AbstractToken; use Symfony\Component\Security\Core\Role\Role; use Symfony\Component\Security\Core\User\UserInterface; class PostAuthenticationGuardToken extends AbstractToken implements GuardTokenInterface { private $providerKey; public function __construct(UserInterface $user, $providerKey, array $roles) { parent::__construct($roles); if (empty($providerKey)) { throw new \InvalidArgumentException('$providerKey (i.e. firewall key) must not be empty.'); } $this->setUser($user); $this->providerKey = $providerKey; parent::setAuthenticated(true); } public function getCredentials() { return array(); } public function getProviderKey() { return $this->providerKey; } public function serialize() { return serialize(array($this->providerKey, parent::serialize())); } public function unserialize($serialized) { list($this->providerKey, $parentStr) = unserialize($serialized); parent::unserialize($parentStr); } } 